version: '2.4'

services:

  db:
    extends:
      file: docker/common/app.yml
      service: postgres

    env_file:
      - .env

  cache:
    extends:
      file: docker/common/app.yml
      service: redis

    env_file:
      - .env

  cassandra_node_1:
    extends:
      file: docker/common/cassandra.yml
      service: cassandra

    env_file:
      - .env

  cassandra_node_2:
    extends:
      file: docker/common/cassandra.yml
      service: cassandra2

    env_file:
      - .env

  cassandra_node_3:
    extends:
      file: docker/common/cassandra.yml
      service: cassandra3

    env_file:
      - .env

  app:

    depends_on:
      - db

    extends:
      file: docker/common/app.yml
      service: app

    env_file:
      - .env

  scheduler:

    depends_on:
      - app

    extends:
      file: docker/common/app.yml
      service: celery

    env_file:
      - .env

networks:
  webnet:

volumes:
  pg_data:
  cassandra_data:
  cassandra2_data:
  cassandra3_data: